{"ast":null,"code":"import _slicedToArray from\"/Users/eddie/Documents/GitHub/quick-travis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import Card from\"@material-ui/core/Card\";import CardContent from\"@material-ui/core/CardContent\";import Button from\"@material-ui/core/Button\";import Typography from\"@material-ui/core/Typography\";import Container from\"@material-ui/core/Container\";import firebase from\"../shared/firebase\";var db=firebase.database().ref();var useStyles=makeStyles({root:{width:\"280px\",boxShadow:\"3px 3px 25px 2px rgba(0,0,0,0.5)\"},title:{fontSize:14},pos:{marginBottom:12}});var Invite=function Invite(_ref){var goal=_ref.goal,user=_ref.user;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),creatorName=_useState4[0],setCreatorName=_useState4[1];var classes=useStyles();useEffect(function(){var users=Object.keys(goal[\"progress\"]);for(var j=0;j<=getDayOn();j++){if(goal[\"progress\"][users[0]][j]==undefined){db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(users[0]).child(j).set(0);//console.log(\"updating db for goal \" + goal.key + \" for user \" + users[0])\n}if(goal[\"progress\"][users[1]][j]==undefined){db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(users[1]).child(j).set(0);//console.log(\"updating db for goal \" + goal.key + \" for user \" + users[1])\n}}},[]);useEffect(function(){setProgress(getProgress);},[goal]);var getDayOn=function getDayOn(){var startdate=new Date(goal[\"startDate\"]);var currentdate=new Date();var deltatime=currentdate.getTime()-startdate.getTime();var deltadays=Math.floor(deltatime/(1000*3600*24));return deltadays;};var getProgress=function getProgress(){var onDayNum=getDayOn();var checkedIn=goal[\"progress\"][user.uid][onDayNum];return checkedIn;};var accept=function accept(){db.child(\"goals\").child(goal[\"key\"]).child(\"confirmed\").set(true);alert(\"accept!\");};var reject=function reject(){//delete goals\ndb.child(\"goals\").child(goal[\"key\"]).child(\"confirmed\").set(true);db.child(\"users\").child(goal[\"groupMembers\"][\"invitee\"]).child(\"invites\").child(goal[\"key\"]).set(null);db.child(\"goals\").child(goal[\"key\"]).child(\"rejected\").set(true);alert(\"reject!\");};useEffect(function(){var setCreatorNameCallback=function setCreatorNameCallback(snap){if(snap.val()){setCreatorName(snap.val()[goal[\"groupMembers\"][\"creator\"]][\"name\"]);}};var dbUsers=firebase.database().ref(\"users\");dbUsers.on(\"value\",setCreatorNameCallback,function(error){return alert(error);});return function(){dbUsers.off(\"value\",setCreatorNameCallback);};},[]);return/*#__PURE__*/React.createElement(Card,{className:classes.root},/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(\"div\",{style:{display:\"inline-block\"}},/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",component:\"h2\"},goal[\"title\"]),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\"},/*#__PURE__*/React.createElement(\"br\",null),\"Invite From: \",creatorName,/*#__PURE__*/React.createElement(\"br\",null),\"Start Date: \",goal[\"startDate\"],/*#__PURE__*/React.createElement(\"br\",null),\"Duration: \",goal[\"duration\"],\" Weeks\",/*#__PURE__*/React.createElement(\"br\",null),\"Daily Goal: \",goal[\"minimum\"],\" \",goal[\"metric\"])),/*#__PURE__*/React.createElement(Container,{style:{marginLeft:\"auto\",marginRight:\"auto\",display:\"inline-block\"}},/*#__PURE__*/React.createElement(Button,{size:\"small\",variant:\"contained\",color:\"primary\",style:{float:\"left\",marginBottom:\"10px\"},onClick:accept},\"Accept\"),/*#__PURE__*/React.createElement(Button,{size:\"small\",variant:\"contained\",color:\"primary\",style:{float:\"right\",marginBottom:\"10px\"},onClick:reject},\"Reject\"))));};export default Invite;","map":{"version":3,"sources":["/Users/eddie/Documents/GitHub/quick-travis/src/Card/Invite.js"],"names":["React","useState","useEffect","makeStyles","Card","CardContent","Button","Typography","Container","firebase","db","database","ref","useStyles","root","width","boxShadow","title","fontSize","pos","marginBottom","Invite","goal","user","progress","setProgress","creatorName","setCreatorName","classes","users","Object","keys","j","getDayOn","undefined","child","set","getProgress","startdate","Date","currentdate","deltatime","getTime","deltadays","Math","floor","onDayNum","checkedIn","uid","accept","alert","reject","setCreatorNameCallback","snap","val","dbUsers","on","error","off","display","marginLeft","marginRight","float"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Container from \"@material-ui/core/Container\";\nimport firebase from \"../shared/firebase\";\n\nconst db = firebase.database().ref();\n\nconst useStyles = makeStyles({\n  root: {\n    width:\"280px\",\n    boxShadow: \"3px 3px 25px 2px rgba(0,0,0,0.5)\",\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  }\n});\n\nconst Invite = ({ goal, user }) => {\n  const [progress, setProgress] = useState(0);\n  const [creatorName, setCreatorName] = useState('');\n\n  const classes = useStyles();\n  \n  useEffect(() => {\n    let users = Object.keys(goal[\"progress\"]);\n    for(let j = 0; j <= getDayOn(); j++){\n      if(goal[\"progress\"][users[0]][j] == undefined){\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(users[0])\n          .child(j)\n          .set(0);\n          //console.log(\"updating db for goal \" + goal.key + \" for user \" + users[0])\n      }\n      if(goal[\"progress\"][users[1]][j] == undefined){\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(users[1])\n          .child(j)\n          .set(0);\n          //console.log(\"updating db for goal \" + goal.key + \" for user \" + users[1])\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    setProgress(getProgress);\n  }, [goal]);\n\n  const getDayOn = () => {\n    var startdate = new Date(goal[\"startDate\"]);\n    var currentdate = new Date();\n    let deltatime = currentdate.getTime() - startdate.getTime();\n    let deltadays = Math.floor(deltatime / (1000 * 3600 * 24));\n    return deltadays;\n  };\n\n  const getProgress = () => {\n    const onDayNum = getDayOn();\n    const checkedIn = goal[\"progress\"][user.uid][onDayNum];\n    return checkedIn;\n  };\n\n  const accept = () => {\n    db.child(\"goals\").child(goal[\"key\"]).child(\"confirmed\").set(true);\n    alert(\"accept!\");\n  };\n\n  const reject = () => {\n    //delete goals\n    db.child(\"goals\").child(goal[\"key\"]).child(\"confirmed\").set(true);\n    db.child(\"users\").child(goal[\"groupMembers\"][\"invitee\"]).child(\"invites\").child(goal[\"key\"]).set(null);\n    db.child(\"goals\").child(goal[\"key\"]).child(\"rejected\").set(true);\n    alert(\"reject!\");\n  };\n\n  useEffect(() => {\n    const setCreatorNameCallback = (snap) => {\n      if (snap.val()) {\n        setCreatorName(\n          snap.val()[goal[\"groupMembers\"][\"creator\"]][\"name\"]\n        )\n      }\n    };\n    const dbUsers = firebase.database().ref(\"users\");\n    dbUsers.on(\"value\", setCreatorNameCallback, (error) => alert(error));\n    return () => {\n      dbUsers.off(\"value\", setCreatorNameCallback);\n    };\n  }, []);\n\n  return (\n    <Card className={classes.root}>\n      <CardContent>\n        <div style={{display: \"inline-block\" }}>\n          <Typography variant=\"h5\" component=\"h2\">\n            {goal[\"title\"]}\n          </Typography>\n          <Typography className={classes.pos} color=\"textSecondary\">\n            <br></br>\n            Invite From: {creatorName}\n            <br></br>\n            Start Date: {goal[\"startDate\"]}\n            <br></br>\n            Duration: {goal[\"duration\"]} Weeks\n            <br></br>\n            Daily Goal: {goal[\"minimum\"]} {goal[\"metric\"]}\n          </Typography>\n        </div>\n        <Container style={{ marginLeft: \"auto\", marginRight: \"auto\", display: \"inline-block\"}}>\n          <Button\n            size=\"small\"\n            variant=\"contained\"\n            color=\"primary\"\n            style={{float: \"left\", marginBottom: \"10px\" }}\n            onClick={accept}\n          >\n            Accept\n          </Button>\n          <Button\n            size=\"small\"\n            variant=\"contained\"\n            color=\"primary\"\n            style={{float: \"right\", marginBottom: \"10px\"}}\n            onClick={reject}\n          >\n            Reject\n          </Button>\n        </Container>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default Invite;\n"]},"metadata":{},"sourceType":"module"}