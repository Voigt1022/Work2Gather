{"ast":null,"code":"import _slicedToArray from\"/Users/eddie/Documents/GitHub/quick-travis/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import Card from\"@material-ui/core/Card\";import CardActions from\"@material-ui/core/CardActions\";import CardContent from\"@material-ui/core/CardContent\";import Button from\"@material-ui/core/Button\";import Typography from\"@material-ui/core/Typography\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableContainer from\"@material-ui/core/TableContainer\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import Slider from\"@material-ui/core/Slider\";import{TextField}from\"@material-ui/core\";import Container from\"@material-ui/core/Container\";import clsx from'clsx';import Badge from'@material-ui/core/Badge';import ClearIcon from'@material-ui/icons/Clear';import NotificationsIcon from\"@material-ui/icons/Notifications\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import SeeMore from\"./SeeMore\";import firebase from\"../shared/firebase\";var db=firebase.database().ref();var useStyles=makeStyles({root:{margin:\"auto\",minWidth:\"35%\",boxShadow:\"3px 3px 25px 2px rgba(0,0,0,0.5)\"// marginLeft: \"5%\",\n// marginRight: \"5%\",\n// overflow: \"auto\",\n// marginTop: \"50px\",\n// display: \"inline-block\",\n// border: \"1px solid black\"\n},title:{fontSize:14},table:{tableLayout:\"auto\",width:\"99.9%\",marginTop:\"0px\",marginBottom:\"10px\"},marginless:{margin:0},tableCont:{width:\"300\"},progressFilled1:{size:\"small\",backgroundColor:\"#14ECF5\",//our own special blue\nborder:\"1px solid black\"},progressFilled2:{size:\"small\",backgroundColor:\"#14F58E\",//our own special green\nborder:\"1px solid black\"},progressUnfilled:{size:\"small\",border:\"1px solid black\"},pos:{marginBottom:12},ourSpecialBlue:{backgroundColor:\"#14ECF5\",//our own special blue\npadding:\"5px\"},ourSpecialGreen:{backgroundColor:\"#14F58E\",//our own special green\npadding:\"5px\"},weekDays:{size:\"small\",borderBottom:\"1px solid black\",paddingBottom:\"0px\",paddingTop:\"10px\",textAlign:\"center\",width:\"50px\"},onDays:{size:\"small\",borderBottom:\"1px solid black\",paddingBottom:\"0px\",paddingTop:\"10px\",textAlign:\"center\",width:\"50px\",backgroundColor:\"#14ECF5\"},update:{display:\"flex\",justifyContent:\"center\",flexDirection:\"column\"},shape1:{backgroundColor:\"#14ECF5\",opacity:0.5},shape2:{backgroundColor:\"#14F58E\",opacity:0.5},shapeCircle:{borderRadius:\"50%\"},goalCircle:{backgroundColor:\"white\"},backCircle:{backgroundColor:\"black\"}});var Goal=function Goal(_ref){var goal=_ref.goal,user=_ref.user;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),checkedIn=_useState4[0],setCheckedIn=_useState4[1];var _useState5=useState(React.createRef()),_useState6=_slicedToArray(_useState5,2),circle1Ref=_useState6[0],setCircle1Ref=_useState6[1];var _useState7=useState(React.createRef()),_useState8=_slicedToArray(_useState7,2),circle2Ref=_useState8[0],setCircle2Ref=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),circle1Left=_useState10[0],setCircle1Left=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),circle1Top=_useState12[0],setCircle1Top=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),circle1Radius=_useState14[0],setCircle1Radius=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),circle2Left=_useState16[0],setCircle2Left=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),circle2Top=_useState18[0],setCircle2Top=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),circle2Radius=_useState20[0],setCircle2Radius=_useState20[1];var _useState21=useState(React.createRef()),_useState22=_slicedToArray(_useState21,2),goalCircleRef=_useState22[0],setGoalCircleRef=_useState22[1];var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),goalCircleLeft=_useState24[0],setGoalCircleLeft=_useState24[1];var _useState25=useState(0),_useState26=_slicedToArray(_useState25,2),goalCircleTop=_useState26[0],setGoalCircleTop=_useState26[1];var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),goalCircleRadius=_useState28[0],setGoalCircleRadius=_useState28[1];var _useState29=useState(React.createRef()),_useState30=_slicedToArray(_useState29,2),backCircleRef=_useState30[0],setBackCircleRef=_useState30[1];var _useState31=useState(0),_useState32=_slicedToArray(_useState31,2),backCircleLeft=_useState32[0],setBackCircleLeft=_useState32[1];var _useState33=useState(0),_useState34=_slicedToArray(_useState33,2),backCircleTop=_useState34[0],setBackCircleTop=_useState34[1];var _useState35=useState(0),_useState36=_slicedToArray(_useState35,2),backCircleRadius=_useState36[0],setBackCircleRadius=_useState36[1];var _useState37=useState(React.createRef()),_useState38=_slicedToArray(_useState37,2),fullCardRef=_useState38[0],setFullCardRef=_useState38[1];var _useState39=useState(\"\"),_useState40=_slicedToArray(_useState39,2),creatorName=_useState40[0],setCreatorName=_useState40[1];var _useState41=useState(\"\"),_useState42=_slicedToArray(_useState41,2),inviteeName=_useState42[0],setInviteeName=_useState42[1];var _useState43=useState(-1),_useState44=_slicedToArray(_useState43,2),lastRemindDay=_useState44[0],setLastRemindDay=_useState44[1];var _useState45=useState(false),_useState46=_slicedToArray(_useState45,2),open=_useState46[0],setOpen=_useState46[1];var classes=useStyles();useEffect(function(){var users=Object.keys(goal[\"progress\"]);for(var j=0;j<=getDayOn();j++){console.log(users[0]);console.log(users[1]);console.log(goal[\"progress\"][users[0]][j]);console.log(goal[\"progress\"][users[1]][j]);if(goal[\"progress\"][users[0]][j]==undefined){db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(users[0]).child(j).set(0);//console.log(\"updating db for goal \" + goal.key + \" for user \" + users[0]);\n}if(goal[\"progress\"][users[1]][j]==undefined){db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(users[1]).child(j).set(0);//console.log(\"updating db for goal \" + goal.key + \" for user \" + users[1]);\n}}var setGoalUserNames=function setGoalUserNames(snap){if(snap.val()){setCreatorName(snap.val()[goal[\"groupMembers\"][\"creator\"]][\"name\"].split(\" \")[0]);setInviteeName(snap.val()[goal[\"groupMembers\"][\"invitee\"]][\"name\"].split(\" \")[0]);}};var dbUsers=firebase.database().ref(\"users\");dbUsers.on(\"value\",setGoalUserNames,function(error){return alert(error);});return function(){dbUsers.off(\"value\",setGoalUserNames);};},[]);useEffect(function(){setProgress(getProgress);var fullCardWidth=fullCardRef.current.offsetWidth;var fullCardHeight=fullCardRef.current.offsetHeight;var goalRadius=fullCardWidth*0.3;var backRadius=fullCardWidth*0.31;setBackCircleRadius(backRadius);setBackCircleTop(0);setBackCircleLeft(fullCardWidth/2-backRadius/2);setGoalCircleRadius(goalRadius);setGoalCircleTop(0-goalRadius/2+backRadius/2);setGoalCircleLeft(fullCardWidth/2-goalRadius/2);var circle1Radius=fullCardWidth*0.3*(goal[\"progress\"][goal[\"groupMembers\"][\"creator\"]][getDayOn()]/goal[\"minimum\"]);setCircle1Radius(circle1Radius);setCircle1Left(fullCardWidth/2-circle1Radius/2);setCircle1Top(0-circle1Radius/2+backRadius/2);var circle2Radius=fullCardWidth*0.3*(goal[\"progress\"][goal[\"groupMembers\"][\"invitee\"]][getDayOn()]/goal[\"minimum\"]);setCircle2Radius(circle2Radius);setCircle2Left(fullCardWidth/2-circle2Radius/2);setCircle2Top(0-circle2Radius/2+backRadius/2);//  Reminder Notifications\nsetLastRemindDay(getReminder(user.id));},[goal]);var getDayOn=function getDayOn(){var startdate=new Date(goal[\"startDate\"]);var currentdate=new Date();var deltatime=currentdate.getTime()-startdate.getTime();var deltadays=Math.floor(deltatime/(1000*3600*24));return deltadays;};var getProgress=function getProgress(){var onDayNum=getDayOn();var checkedIn=goal[\"progress\"][user.uid][onDayNum];return checkedIn;};var saveProgress=function saveProgress(event,value){setProgress(event.target.value);};var updateProgress=function updateProgress(event,value){var onDayNum=getDayOn();if(progress===\"\"){alert(\"Not a number\");}else{if(goal['goalType']=='Quantitative'){db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(user.uid).child(onDayNum).set(parseInt(progress));setCheckedIn(true);}else{db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(user.uid).child(onDayNum).set(1);setCheckedIn(true);}}};var handleSliderChange=function handleSliderChange(e,newValue){var onDayNum=getDayOn();db.child(\"goals\").child(goal[\"key\"]).child(\"progress\").child(user.uid).child(onDayNum).set(newValue);};var setReminder=function setReminder(){alert(\"You have reminded your friend!\");var onDayNum=getDayOn();if(user.uid===goal.groupMembers.creator){db.child(\"goals\").child(goal[\"key\"]).child(\"lastRemindInvitee\").set(onDayNum);}else{db.child(\"goals\").child(goal[\"key\"]).child(\"lastRemindCreator\").set(onDayNum);}};var getReminder=function getReminder(){var onDayNum=getDayOn();if(user.uid===goal.groupMembers.creator){return goal[\"lastRemindCreator\"];}else{return goal[\"lastRemindInvitee\"];}};var deleteGoal=function deleteGoal(){if(user.uid===goal.groupMembers.creator){db.child('users').child(goal.groupMembers.creator).child('goals').child(goal.key).set(null);db.child('goals').child(goal.key).child('deleted').set(true);}else{db.child('users').child(goal.groupMembers.invitee).child('invites').child(goal.key).set(null);db.child('goals').child(goal.key).child('deleted').set(true);}// db.child('goals').child(goal.key).set(null);\n};var archiveGoal=function archiveGoal(){if(user.uid===goal.groupMembers.creator){db.child('goals').child(goal.key).child('archivedCreator').set(true);}else{db.child('goals').child(goal.key).child('archivedInvitee').set(true);}setOpen(false);// db.child('goals').child(goal.key).set(null);\n};return/*#__PURE__*/React.createElement(Badge,{anchorOrigin:{vertical:\"top\",horizontal:\"left\"},color:\"secondary\",badgeContent:/*#__PURE__*/React.createElement(NotificationsIcon,{fontSize:\"small\"}),invisible:!(getDayOn()===lastRemindDay&&goal[\"progress\"][user.uid][getDayOn()]<goal[\"minimum\"])},/*#__PURE__*/React.createElement(Badge,{badgeContent:/*#__PURE__*/React.createElement(ClearIcon,{onClick:function onClick(){return setOpen(true);}}),color:\"primary\",anchorOrigin:{vertical:'top',horizontal:'right'}},/*#__PURE__*/React.createElement(Dialog,{open:open,onClose:function onClose(){return setOpen(false);}},/*#__PURE__*/React.createElement(DialogContent,null,\"Are you sure you want to archive or delete this goal?\"),/*#__PURE__*/React.createElement(DialogActions,null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return setOpen(false);}},\"Cancel\"),goal.confirmed?/*#__PURE__*/React.createElement(Button,{onClick:archiveGoal},\"Archive\"):null,/*#__PURE__*/React.createElement(Button,{onClick:deleteGoal},\"Delete\"))),/*#__PURE__*/React.createElement(Card,{className:classes.root},/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(\"div\",{style:{width:\"80%\",display:\"inline-block\"}},/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",component:\"h2\"},goal[\"title\"]),/*#__PURE__*/React.createElement(Typography,{className:classes.pos,color:\"textSecondary\"},/*#__PURE__*/React.createElement(\"br\",null),\"Started: \",goal[\"startDate\"],/*#__PURE__*/React.createElement(\"br\",null),\"Days Left: \",goal[\"duration\"]*7-getDayOn(),/*#__PURE__*/React.createElement(\"br\",null))),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"20%\",display:\"inline-block\",float:\"right\"}},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableBody,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{className:classes.ourSpecialBlue},\" \",creatorName)),/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{className:classes.ourSpecialGreen},\" \",inviteeName))))),/*#__PURE__*/React.createElement(\"div\",{ref:fullCardRef,style:{position:\"relative\",height:backCircleRadius*1.05,width:\"100%\"}},/*#__PURE__*/React.createElement(\"div\",{style:{overflow:\"visible\",position:\"absolute\",left:backCircleLeft,top:backCircleTop,width:backCircleRadius,height:backCircleRadius},className:clsx(classes.backCircle,classes.shapeCircle)}),/*#__PURE__*/React.createElement(\"div\",{ref:goalCircleRef,style:{overflow:\"visible\",position:\"absolute\",left:goalCircleLeft,top:goalCircleTop,width:goalCircleRadius,height:goalCircleRadius},className:clsx(classes.goalCircle,classes.shapeCircle)}),/*#__PURE__*/React.createElement(\"div\",{ref:circle1Ref,style:{overflow:\"visible\",position:\"absolute\",left:circle1Left,top:circle1Top,width:circle1Radius,height:circle1Radius},className:clsx(classes.shape1,classes.shapeCircle)}),/*#__PURE__*/React.createElement(\"div\",{ref:circle2Ref,style:{overflow:\"visible\",position:\"absolute\",left:circle2Left,top:circle2Top,width:circle2Radius,height:circle2Radius},className:clsx(classes.shape2,classes.shapeCircle)})),/*#__PURE__*/React.createElement(CardActions,{className:classes.update},/*#__PURE__*/React.createElement(Typography,null,/*#__PURE__*/React.createElement(\"b\",null,\"Day \",getDayOn(),\" \")),goal.deleted||goal.rejected?/*#__PURE__*/React.createElement(Typography,null,goal.rejected?\"Your friend has rejected the goal invite.\":\"Your friend has removed the goal.\"):/*#__PURE__*/React.createElement(\"div\",{style:{height:'23px'}}),/*#__PURE__*/React.createElement(Typography,null,\"Daily Goal: \",goal[\"minimum\"],\" \",goal[\"metric\"]),goal[\"goalType\"]===\"Quantitative\"?/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",type:\"number\",onChange:saveProgress,defaultValue:progress,size:\"small\",style:{width:\"176px\"}}):/*#__PURE__*/React.createElement(\"div\",{style:{height:'40px'}}),/*#__PURE__*/React.createElement(Button,{size:\"medium\",variant:\"contained\",color:\"primary\",style:{marginTop:\"10px\"},onClick:updateProgress},goal[\"goalType\"]===\"Quantitative\"?'Update Progress':'Mark Complete')),/*#__PURE__*/React.createElement(CardActions,{style:{marginBottom:'-15px'}},/*#__PURE__*/React.createElement(Button,{size:\"medium\",variant:\"contained\",color:\"secondary\",onClick:setReminder,style:{width:\"56%\"}},\"Remind Friend\"),/*#__PURE__*/React.createElement(SeeMore,{goal:goal}))))));};export default Goal;","map":{"version":3,"sources":["/Users/eddie/Documents/GitHub/quick-travis/src/Card/Goal.js"],"names":["React","useState","useEffect","makeStyles","Card","CardActions","CardContent","Button","Typography","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Slider","TextField","Container","clsx","Badge","ClearIcon","NotificationsIcon","Dialog","DialogActions","DialogContent","DialogTitle","SeeMore","firebase","db","database","ref","useStyles","root","margin","minWidth","boxShadow","title","fontSize","table","tableLayout","width","marginTop","marginBottom","marginless","tableCont","progressFilled1","size","backgroundColor","border","progressFilled2","progressUnfilled","pos","ourSpecialBlue","padding","ourSpecialGreen","weekDays","borderBottom","paddingBottom","paddingTop","textAlign","onDays","update","display","justifyContent","flexDirection","shape1","opacity","shape2","shapeCircle","borderRadius","goalCircle","backCircle","Goal","goal","user","progress","setProgress","checkedIn","setCheckedIn","createRef","circle1Ref","setCircle1Ref","circle2Ref","setCircle2Ref","circle1Left","setCircle1Left","circle1Top","setCircle1Top","circle1Radius","setCircle1Radius","circle2Left","setCircle2Left","circle2Top","setCircle2Top","circle2Radius","setCircle2Radius","goalCircleRef","setGoalCircleRef","goalCircleLeft","setGoalCircleLeft","goalCircleTop","setGoalCircleTop","goalCircleRadius","setGoalCircleRadius","backCircleRef","setBackCircleRef","backCircleLeft","setBackCircleLeft","backCircleTop","setBackCircleTop","backCircleRadius","setBackCircleRadius","fullCardRef","setFullCardRef","creatorName","setCreatorName","inviteeName","setInviteeName","lastRemindDay","setLastRemindDay","open","setOpen","classes","users","Object","keys","j","getDayOn","console","log","undefined","child","set","setGoalUserNames","snap","val","split","dbUsers","on","error","alert","off","getProgress","fullCardWidth","current","offsetWidth","fullCardHeight","offsetHeight","goalRadius","backRadius","getReminder","id","startdate","Date","currentdate","deltatime","getTime","deltadays","Math","floor","onDayNum","uid","saveProgress","event","value","target","updateProgress","parseInt","handleSliderChange","e","newValue","setReminder","groupMembers","creator","deleteGoal","key","invitee","archiveGoal","vertical","horizontal","confirmed","float","position","height","overflow","left","top","deleted","rejected"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Slider from \"@material-ui/core/Slider\";\nimport { TextField } from \"@material-ui/core\";\nimport Container from \"@material-ui/core/Container\";\nimport clsx from 'clsx';\nimport Badge from '@material-ui/core/Badge';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport NotificationsIcon from \"@material-ui/icons/Notifications\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport SeeMore from \"./SeeMore\"\nimport firebase from \"../shared/firebase\";\n\nconst db = firebase.database().ref();\n\nconst useStyles = makeStyles({\n  root: {\n    margin: \"auto\",\n    minWidth: \"35%\",\n    boxShadow: \"3px 3px 25px 2px rgba(0,0,0,0.5)\",\n    // marginLeft: \"5%\",\n    // marginRight: \"5%\",\n    // overflow: \"auto\",\n    // marginTop: \"50px\",\n    // display: \"inline-block\",\n    // border: \"1px solid black\"\n  },\n  title: {\n    fontSize: 14,\n  },\n  table: {\n    tableLayout: \"auto\",\n    width: \"99.9%\",\n    marginTop: \"0px\",\n    marginBottom: \"10px\",\n  },\n  marginless: {\n    margin: 0,\n  },\n  tableCont: {\n    width: \"300\",\n  },\n  progressFilled1: {\n    size: \"small\",\n    backgroundColor: \"#14ECF5\", //our own special blue\n    border: \"1px solid black\",\n  },\n  progressFilled2: {\n    size: \"small\",\n    backgroundColor: \"#14F58E\", //our own special green\n    border: \"1px solid black\",\n  },\n  progressUnfilled: {\n    size: \"small\",\n    border: \"1px solid black\",\n  },\n  pos: {\n    marginBottom: 12,\n  },\n  ourSpecialBlue: {\n    backgroundColor: \"#14ECF5\", //our own special blue\n    padding: \"5px\",\n  },\n  ourSpecialGreen: {\n    backgroundColor: \"#14F58E\", //our own special green\n    padding: \"5px\",\n  },\n  weekDays: {\n    size: \"small\",\n    borderBottom: \"1px solid black\",\n    paddingBottom: \"0px\",\n    paddingTop: \"10px\",\n    textAlign: \"center\",\n    width: \"50px\",\n  },\n  onDays: {\n    size: \"small\",\n    borderBottom: \"1px solid black\",\n    paddingBottom: \"0px\",\n    paddingTop: \"10px\",\n    textAlign: \"center\",\n    width: \"50px\",\n    backgroundColor: \"#14ECF5\",\n  },\n  update:{\n    display:\"flex\",\n    justifyContent: \"center\",\n    flexDirection: \"column\",\n  },\n  shape1: {\n    backgroundColor: \"#14ECF5\",\n    opacity: 0.5,\n  },\n  shape2: {\n    backgroundColor: \"#14F58E\",\n    opacity: 0.5,\n  },\n  shapeCircle: {\n    borderRadius: \"50%\",\n  },\n  goalCircle: {\n    backgroundColor: \"white\",\n  },\n  backCircle: {\n    backgroundColor: \"black\",\n  },\n});\n\nconst Goal = ({ goal, user }) => {\n  const [progress, setProgress] = useState(0);\n  const [checkedIn, setCheckedIn] = useState(false);\n  \n  const [circle1Ref, setCircle1Ref] = useState(React.createRef());\n  const [circle2Ref, setCircle2Ref] = useState(React.createRef());\n  const [circle1Left, setCircle1Left] = useState(0);\n  const [circle1Top, setCircle1Top] = useState(0);\n  const [circle1Radius, setCircle1Radius] = useState(0);\n\n  const [circle2Left, setCircle2Left] = useState(0);\n  const [circle2Top, setCircle2Top] = useState(0);\n  const [circle2Radius, setCircle2Radius] = useState(0);\n\n  const [goalCircleRef, setGoalCircleRef] = useState(React.createRef());\n  const [goalCircleLeft, setGoalCircleLeft] = useState(0);\n  const [goalCircleTop, setGoalCircleTop] = useState(0);\n  const [goalCircleRadius, setGoalCircleRadius] = useState(0);\n\n  const [backCircleRef, setBackCircleRef] = useState(React.createRef());\n  const [backCircleLeft, setBackCircleLeft] = useState(0);\n  const [backCircleTop, setBackCircleTop] = useState(0);\n  const [backCircleRadius, setBackCircleRadius] = useState(0);\n\n  const [fullCardRef, setFullCardRef] = useState(React.createRef());\n\n  const [creatorName, setCreatorName] = useState(\"\");\n  const [inviteeName, setInviteeName] = useState(\"\");\n\n  const [lastRemindDay, setLastRemindDay] = useState(-1);\n  const [open, setOpen] = useState(false);\n\n  const classes = useStyles();\n\n  useEffect(() => {\n\n    let users = Object.keys(goal[\"progress\"]);\n    for (let j = 0; j <= getDayOn(); j++) {\n      console.log(users[0])\n      console.log(users[1])\n      console.log(goal[\"progress\"][users[0]][j])\n      console.log(goal[\"progress\"][users[1]][j])\n      if (goal[\"progress\"][users[0]][j] == undefined) {\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(users[0])\n          .child(j)\n          .set(0);\n        //console.log(\"updating db for goal \" + goal.key + \" for user \" + users[0]);\n      }\n      if (goal[\"progress\"][users[1]][j] == undefined) {\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(users[1])\n          .child(j)\n          .set(0);\n        //console.log(\"updating db for goal \" + goal.key + \" for user \" + users[1]);\n      }\n    }\n\n    const setGoalUserNames = (snap) => {\n      if (snap.val()) {\n        setCreatorName(\n          snap.val()[goal[\"groupMembers\"][\"creator\"]][\"name\"].split(\" \")[0]\n        );\n        setInviteeName(\n          snap.val()[goal[\"groupMembers\"][\"invitee\"]][\"name\"].split(\" \")[0]\n        );\n      }\n    };\n\n    const dbUsers = firebase.database().ref(\"users\");\n    dbUsers.on(\"value\", setGoalUserNames, (error) => alert(error));\n    return () => {\n      dbUsers.off(\"value\", setGoalUserNames);\n    };\n  }, []);\n\n  useEffect(() => {\n    setProgress(getProgress);\n\n    const fullCardWidth = fullCardRef.current.offsetWidth;\n    const fullCardHeight = fullCardRef.current.offsetHeight;\n\n    const goalRadius = fullCardWidth * 0.3;\n    const backRadius = fullCardWidth * 0.31;\n\n    setBackCircleRadius(backRadius);\n    setBackCircleTop(0);\n    setBackCircleLeft(fullCardWidth / 2 - backRadius / 2);\n\n    setGoalCircleRadius(goalRadius);\n    setGoalCircleTop(0 - goalRadius / 2 + backRadius / 2);\n    setGoalCircleLeft(fullCardWidth / 2 - goalRadius / 2);\n\n    const circle1Radius =\n      fullCardWidth *\n      0.3 *\n      (goal[\"progress\"][goal[\"groupMembers\"][\"creator\"]][getDayOn()] /\n        goal[\"minimum\"]);\n    setCircle1Radius(circle1Radius);\n    setCircle1Left(fullCardWidth / 2 - circle1Radius / 2);\n    setCircle1Top(0 - circle1Radius / 2 + backRadius / 2);\n\n    const circle2Radius =\n      fullCardWidth *\n      0.3 *\n      (goal[\"progress\"][goal[\"groupMembers\"][\"invitee\"]][getDayOn()] /\n        goal[\"minimum\"]);\n    setCircle2Radius(circle2Radius);\n    setCircle2Left(fullCardWidth / 2 - circle2Radius / 2);\n    setCircle2Top(0 - circle2Radius / 2 + backRadius / 2);\n\n    //  Reminder Notifications\n    setLastRemindDay(getReminder(user.id));\n  }, [goal]);\n\n  const getDayOn = () => {\n    var startdate = new Date(goal[\"startDate\"]);\n    var currentdate = new Date();\n    let deltatime = currentdate.getTime() - startdate.getTime();\n    let deltadays = Math.floor(deltatime / (1000 * 3600 * 24));\n    return deltadays;\n  };\n\n  const getProgress = () => {\n    const onDayNum = getDayOn();\n    const checkedIn = goal[\"progress\"][user.uid][onDayNum];\n    return checkedIn;\n  };\n\n  const saveProgress = (event, value) => {\n    setProgress(event.target.value);\n  };\n\n  const updateProgress = (event, value) => {\n    const onDayNum = getDayOn();\n    if (progress === \"\") {\n      alert(\"Not a number\");\n    } else {\n      if (goal['goalType'] == 'Quantitative'){\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(user.uid)\n          .child(onDayNum)\n          .set(parseInt(progress));\n        setCheckedIn(true);\n      } else {\n        db.child(\"goals\")\n          .child(goal[\"key\"])\n          .child(\"progress\")\n          .child(user.uid)\n          .child(onDayNum)\n          .set(1);\n        setCheckedIn(true);\n      }\n    }\n  };\n\n  const handleSliderChange = (e, newValue) => {\n    const onDayNum = getDayOn();\n    db.child(\"goals\")\n      .child(goal[\"key\"])\n      .child(\"progress\")\n      .child(user.uid)\n      .child(onDayNum)\n      .set(newValue);\n  };\n\n  const setReminder = () => {\n    alert(\"You have reminded your friend!\");\n    const onDayNum = getDayOn();\n    if (user.uid === goal.groupMembers.creator) {\n      db.child(\"goals\")\n        .child(goal[\"key\"])\n        .child(\"lastRemindInvitee\")\n        .set(onDayNum);\n    } else {\n      db.child(\"goals\")\n        .child(goal[\"key\"])\n        .child(\"lastRemindCreator\")\n        .set(onDayNum);\n    }\n  };\n\n  const getReminder = () => {\n    const onDayNum = getDayOn();\n    if (user.uid === goal.groupMembers.creator) {\n      return goal[\"lastRemindCreator\"];\n    } else {\n      return goal[\"lastRemindInvitee\"];\n    }\n  };\n\n  const deleteGoal = () => {\n    if(user.uid===goal.groupMembers.creator) {\n      db.child('users').child(goal.groupMembers.creator).child('goals').child(goal.key).set(null);\n      db.child('goals').child(goal.key).child('deleted').set(true);\n    }\n    else {\n      db.child('users').child(goal.groupMembers.invitee).child('invites').child(goal.key).set(null);\n      db.child('goals').child(goal.key).child('deleted').set(true);\n    }\n    // db.child('goals').child(goal.key).set(null);\n  }\n\n  const archiveGoal = () => {\n    if(user.uid===goal.groupMembers.creator) {\n      db.child('goals').child(goal.key).child('archivedCreator').set(true);\n    }\n    else {\n      db.child('goals').child(goal.key).child('archivedInvitee').set(true);\n    }\n    setOpen(false);\n    // db.child('goals').child(goal.key).set(null);\n  }\n\n  return (\n    <Badge\n      anchorOrigin={{ vertical: \"top\", horizontal: \"left\" }}\n      color=\"secondary\"\n      badgeContent={<NotificationsIcon fontSize=\"small\" />}\n      invisible={\n        !(\n          getDayOn() === lastRemindDay &&\n          goal[\"progress\"][user.uid][getDayOn()] < goal[\"minimum\"]\n        )\n      }\n    >\n      <Badge \n      badgeContent={<ClearIcon onClick={()=>setOpen(true)}/>} \n      color=\"primary\"\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: 'right',\n      }}\n      >\n        <Dialog open={open} onClose={()=>setOpen(false)}>\n          <DialogContent>\n            Are you sure you want to archive or delete this goal?\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={()=>setOpen(false)}>Cancel</Button>\n            {goal.confirmed? <Button onClick={archiveGoal}>Archive</Button> : null}\n            <Button onClick={deleteGoal}>Delete</Button>\n          </DialogActions>\n        </Dialog>\n        <Card className={classes.root}>\n          <CardContent>\n            <div style={{ width: \"80%\", display: \"inline-block\" }}>\n              <Typography variant=\"h5\" component=\"h2\">\n                {goal[\"title\"]}\n              </Typography>\n              <Typography className={classes.pos} color=\"textSecondary\">\n                <br></br>\n                Started: {goal[\"startDate\"]}\n                <br></br>\n                Days Left: {goal[\"duration\"] * 7 - getDayOn()}  \n                <br></br>\n              </Typography>\n            </div>\n            <div\n              style={{ width: \"20%\", display: \"inline-block\", float: \"right\" }}\n            >\n              <Table>\n                <TableBody>\n                  <TableRow>\n                    <TableCell className={classes.ourSpecialBlue}>\n                      {\" \"}\n                      {creatorName}\n                    </TableCell>\n                  </TableRow>\n                  <TableRow>\n                    <TableCell className={classes.ourSpecialGreen}>\n                      {\" \"}\n                      {inviteeName}\n                    </TableCell>\n                  </TableRow>\n                </TableBody>\n              </Table>\n            </div>\n            <div\n              ref={fullCardRef}\n              style={{\n                position: \"relative\",\n                height: backCircleRadius * 1.05,\n                width: \"100%\",\n              }}\n            >\n              <div\n                style={{\n                  overflow: \"visible\",\n                  position: \"absolute\",\n                  left: backCircleLeft,\n                  top: backCircleTop,\n                  width: backCircleRadius,\n                  height: backCircleRadius,\n                }}\n                className={clsx(classes.backCircle, classes.shapeCircle)}\n              />\n              <div\n                ref={goalCircleRef}\n                style={{\n                  overflow: \"visible\",\n                  position: \"absolute\",\n                  left: goalCircleLeft,\n                  top: goalCircleTop,\n                  width: goalCircleRadius,\n                  height: goalCircleRadius,\n                }}\n                className={clsx(classes.goalCircle, classes.shapeCircle)}\n              />\n              <div\n                ref={circle1Ref}\n                style={{\n                  overflow: \"visible\",\n                  position: \"absolute\",\n                  left: circle1Left,\n                  top: circle1Top,\n                  width: circle1Radius,\n                  height: circle1Radius,\n                }}\n                className={clsx(classes.shape1, classes.shapeCircle)}\n              />\n              <div\n                ref={circle2Ref}\n                style={{\n                  overflow: \"visible\",\n                  position: \"absolute\",\n                  left: circle2Left,\n                  top: circle2Top,\n                  width: circle2Radius,\n                  height: circle2Radius,\n                }}\n                className={clsx(classes.shape2, classes.shapeCircle)}\n              />\n            </div>\n\n            <CardActions className={classes.update}>\n              <Typography>\n                <b>Day {getDayOn()} </b>\n              </Typography>\n              {(goal.deleted||goal.rejected)?<Typography>{goal.rejected? \"Your friend has rejected the goal invite.\" :\"Your friend has removed the goal.\"}</Typography>:<div style={{height:'23px'}}></div>}\n              <Typography >\n                Daily Goal: {goal[\"minimum\"]} {goal[\"metric\"]}\n              </Typography>\n              {goal[\"goalType\"] === \"Quantitative\" ? \n              <TextField\n                variant=\"outlined\"\n                type=\"number\"\n                onChange={saveProgress}\n                defaultValue={progress}\n                size=\"small\"\n                style={{ width: \"176px\" }}\n              /> : <div style={{height:'40px'}}></div> }\n              <Button\n                size=\"medium\"\n                variant=\"contained\"\n                color=\"primary\"\n                style={{ marginTop: \"10px\" }}\n                onClick={updateProgress}\n              >\n                 {goal[\"goalType\"] === \"Quantitative\" ? 'Update Progress' : 'Mark Complete' } \n              </Button>\n            </CardActions>\n\n            <CardActions style={{marginBottom:'-15px'}}>\n              <Button\n                size=\"medium\"\n                variant=\"contained\"\n                color=\"secondary\"\n                onClick={setReminder}\n                style={{width:\"56%\"}}\n              >\n                Remind Friend\n              </Button>\n              <SeeMore goal={goal}/>\n            </CardActions>\n            {/* <div style={{ marginTop:\"5px\", marginBottom:\"30px\"}}>\n              <div style={{float:\"left\", marginRight: \"10px\"}}>\n                <Button\n                    size=\"medium\"\n                    variant=\"contained\"\n                    color=\"secondary\"\n                    onClick={setReminder}\n                  >\n                  Remind Friend\n                </Button>\n              </div>\n              <div style={{float:\"right\"}}>\n                <SeeMore goal={goal} />\n              </div>\n            </div> */}\n          </CardContent>\n        </Card>\n      </Badge>\n    </Badge>\n  );\n};\n\nexport default Goal;\n"]},"metadata":{},"sourceType":"module"}